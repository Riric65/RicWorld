<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RicQuiz</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;600;800&display=swap');

        :root {
            --primary: #00f260;
            --secondary: #0575e6;
            --bg-dark: #0f0c29;
            --glass: rgba(255, 255, 255, 0.05);
            --glass-hover: rgba(255, 255, 255, 0.1);
            --border: rgba(255, 255, 255, 0.1);
        }

        body {
            margin: 0;
            font-family: 'Inter', sans-serif;
            background: var(--bg-dark);
            color: white;
            overflow-x: hidden;
        }

        /* --- NAVBAR --- */
        nav {
            display: flex;
            justify-content: left; /* Centré car plus de liens */
            align-items: center;
            padding: 20px 5%;
            background: rgba(15, 12, 41, 0.9);
            backdrop-filter: blur(10px);
            position: fixed;
            width: 90%;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid var(--border);
        }

        .nav-logo {
            font-weight: 800;
            font-size: 1.8em;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-decoration: none;
            letter-spacing: 1px;
        }

        /* --- CONTENU PRINCIPAL --- */
        main {
            padding: 120px 10% 50px 10%; /* Marge haute pour la navbar */
            min-height: 80vh;
            max-width: 1200px;
            margin: 0 auto;
        }

        h2 { font-size: 2em; margin-bottom: 20px; color: white; border-left: 4px solid var(--primary); padding-left: 15px; }

        /* --- BARRE DE RECHERCHE --- */
        .controls-bar {
            display: flex;
            gap: 15px;
            margin-bottom: 40px;
            background: var(--glass);
            padding: 20px;
            border-radius: 15px;
            border: 1px solid var(--border);
            flex-wrap: wrap;
        }

        input, select {
            padding: 15px;
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border);
            border-radius: 10px;
            color: white;
            font-family: 'Inter', sans-serif;
            font-size: 1rem;
            outline: none;
        }

        input { flex: 2; min-width: 200px; }
        select { flex: 1; min-width: 150px; cursor: pointer; }
        
        input:focus, select:focus { border-color: var(--primary); }
        select option { background: var(--bg-dark); }

        /* --- GRILLE --- */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
        }

        .card {
            background: var(--glass);
            padding: 25px;
            border-radius: 15px;
            border: 1px solid var(--border);
            transition: 0.3s;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .card:hover {
            transform: translateY(-5px);
            border-color: var(--secondary);
            background: var(--glass-hover);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .card-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 15px; }
        .card h3 { margin: 0 0 10px 0; font-size: 1.4em; }
        .card p { font-size: 0.95em; color: #aaa; margin: 0; line-height: 1.5; }
        
        .tag {
            font-size: 0.75em;
            background: rgba(5, 117, 230, 0.2);
            padding: 5px 12px;
            border-radius: 20px;
            color: #8ec5fc;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }
        
        .card i { font-size: 2em; color: var(--glass-hover); transition: 0.3s; }
        .card:hover i { color: var(--primary); }

        .card-footer {
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9em;
            color: var(--primary);
            font-weight: 600;
        }

        /* --- JEU PLEIN ECRAN --- */
        #game-engine {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #0f0c29; z-index: 2000; display: none;
            flex-direction: column; align-items: center; justify-content: center;
        }
        
        .game-header {
            position: absolute; top: 0; width: 100%; padding: 20px;
            display: flex; justify-content: space-between; align-items: center;
            box-sizing: border-box; background: rgba(0,0,0,0.2);
        }

        .progress-bar { width: 100%; height: 5px; background: #333; position: absolute; bottom: 0; left: 0; }
        .progress-fill { height: 100%; background: var(--primary); width: 0%; transition: width 0.3s; }

        .question-container { text-align: center; max-width: 800px; width: 90%; }
        .question-text { font-size: 2.2em; font-weight: 800; margin-bottom: 50px; line-height: 1.3; }

        .options-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        
        .option-card {
            background: var(--glass); padding: 25px; border-radius: 15px;
            border: 2px solid var(--border); cursor: pointer; font-size: 1.1em; transition: 0.2s;
            text-align: left; font-weight: 600;
        }
        .option-card:hover { background: var(--glass-hover); border-color: #aaa; }
        .option-card.correct { border-color: var(--primary); background: rgba(0, 242, 96, 0.15); color: var(--primary); }
        .option-card.wrong { border-color: #ff4757; background: rgba(255, 71, 87, 0.15); opacity: 0.7; }
        .option-card.disabled { pointer-events: none; }

        .btn-next {
            margin-top: 40px; padding: 15px 40px;
            background: white; color: var(--bg-dark);
            border: none; border-radius: 30px; font-weight: 800;
            cursor: pointer; font-size: 1em; display: none;
            transition: 0.3s;
        }
        .btn-next:hover { transform: scale(1.05); }

        /* Resultats */
        .result-box { text-align: center; background: var(--glass); padding: 50px; border-radius: 20px; border: 1px solid var(--primary); width: 100%; max-width: 500px; }
        .score-big { font-size: 5em; font-weight: 800; color: var(--primary); margin: 20px 0; }

    </style>
</head>
<body>

    <nav>
        <a href="/" class="nav-logo">Ricworld</a>
    </nav>

    <main>
        <!-- FILTRES -->
        <div class="controls-bar">
            <input type="text" id="search" placeholder="Rechercher un quiz (ex: Planètes...)" onkeyup="filterQuizzes()">
            <select id="catFilter" onchange="filterQuizzes()">
                <option value="all">Toutes les catégories</option>
                <option value="Science">Science</option>
                <option value="Histoire">Histoire</option>
                <option value="Tech">Tech</option>
                <option value="Cinéma">Cinéma</option>
            </select>
        </div>

        <!-- LISTE DES QUIZ -->
        <div class="grid" id="quizGrid">
            <!-- Injecté par JS -->
        </div>
    </main>

    <!-- INTERFACE DE JEU (Cachée par défaut) -->
    <div id="game-engine">
        <div class="game-header">
            <span id="game-title" style="font-weight:bold; color:#ccc; font-size: 0.9em; text-transform:uppercase;">Titre</span>
            <button onclick="quitGame()" style="background:none; border:none; color:white; cursor:pointer; font-size:2em;">&times;</button>
            <div class="progress-bar"><div class="progress-fill" id="progress-fill"></div></div>
        </div>

        <div class="question-container" id="game-ui">
            <div style="margin-bottom:20px; color:var(--primary); font-weight:600; letter-spacing: 2px; font-size: 0.9em;" id="question-counter">QUESTION 1/5</div>
            <div class="question-text" id="q-text">Chargement...</div>
            <div class="options-grid" id="options-area"></div>
            <button class="btn-next" id="next-btn" onclick="nextQuestion()">Question Suivante <i class="fas fa-arrow-right"></i></button>
        </div>

        <div class="result-box" id="result-ui" style="display:none;">
            <h2 style="border:none; margin:0;">Quiz Terminé</h2>
            <div class="score-big" id="final-score">0</div>
            <p id="score-msg" style="font-size:1.2em; color:#ccc;">Bien joué !</p>
            <button class="btn-next" onclick="quitGame()" style="display:inline-block; background: var(--primary); color: var(--bg-dark);">Retour au menu</button>
        </div>
    </div>

    <script>
        // --- DONNÉES DE SECOURS (Si pas de JSON serveur) ---
        const fallbackData = [
            {
                "id": 1, "title": "Astronomie", "category": "Science", "desc": "Voyage à travers le système solaire.", "icon": "fa-user-astronaut",
                "questions": [
                    { "q": "Quelle est la planète la plus proche du soleil ?", "options": ["Vénus", "Mercure", "Mars", "Terre"], "ans": 1 },
                    { "q": "Quelle est la plus grande planète ?", "options": ["Jupiter", "Saturne", "Neptune", "Uranus"], "ans": 0 },
                    { "q": "Combien de lunes a la Terre ?", "options": ["Une", "Deux", "Aucune", "Douze"], "ans": 0 }
                ]
            },
            {
                "id": 2, "title": "Histoire de France", "category": "Histoire", "desc": "Rois, batailles et révolutions.", "icon": "fa-landmark",
                "questions": [
                    { "q": "Année de la chute de l'Empire Romain d'Occident ?", "options": ["476", "1492", "1789", "800"], "ans": 0 },
                    { "q": "Qui a construit le château de Versailles ?", "options": ["Louis XIV", "Napoléon", "Charlemagne", "François 1er"], "ans": 0 }
                ]
            },
            {
                "id": 3, "title": "Cinéma 90s", "category": "Cinéma", "desc": "Les classiques des années 90.", "icon": "fa-film",
                "questions": [
                    { "q": "Qui a réalisé Pulp Fiction ?", "options": ["Scorsese", "Tarantino", "Spielberg", "Nolan"], "ans": 1 },
                    { "q": "Dans Matrix, quelle pilule choisit Neo ?", "options": ["La rouge", "La bleue", "La verte", "Aucune"], "ans": 0 }
                ]
            },
            {
                "id": 4, "title": "Culture Web", "category": "Tech", "desc": "Internet et programmation.", "icon": "fa-wifi",
                "questions": [
                    { "q": "Que signifie 'www' ?", "options": ["World Wide Web", "World Web Wide", "Wide Web World", "Web World Wide"], "ans": 0 },
                    { "q": "Quel animal représente le langage Python ?", "options": ["Un serpent", "Un lion", "Un aigle", "Un ours"], "ans": 0 }
                ]
            }
        ];

        let allQuizzes = [];

        // --- CHARGEMENT ---
        async function init() {
            try {
                // Essai de chargement du fichier JSON externe
                const response = await fetch('quiz.json');
                if (response.ok) {
                    allQuizzes = await response.json();
                } else {
                    throw new Error("Fichier non trouvé");
                }
            } catch (e) {
                console.log("Utilisation des données de secours (Local)");
                allQuizzes = fallbackData;
            }
            renderQuizzes(allQuizzes);
        }

        // --- AFFICHAGE GRILLE ---
        function renderQuizzes(list) {
            const grid = document.getElementById('quizGrid');
            grid.innerHTML = "";

            if(list.length === 0) {
                grid.innerHTML = "<p style='color:#aaa'>Aucun quiz ne correspond à votre recherche.</p>";
                return;
            }

            list.forEach(quiz => {
                const card = document.createElement('div');
                card.className = 'card';
                card.onclick = () => startGame(quiz.id);
                card.innerHTML = `
                    <div class="card-header">
                        <span class="tag">${quiz.category}</span>
                        <i class="fas ${quiz.icon || 'fa-question'}"></i>
                    </div>
                    <div>
                        <h3>${quiz.title}</h3>
                        <p>${quiz.desc}</p>
                    </div>
                    <div class="card-footer">
                        <span><i class="fas fa-play" style="font-size:0.8em; margin-right:5px;"></i> JOUER</span>
                        <span>${quiz.questions.length} Questions</span>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        // --- FILTRES ---
        function filterQuizzes() {
            const text = document.getElementById('search').value.toLowerCase();
            const cat = document.getElementById('catFilter').value;

            const filtered = allQuizzes.filter(q => {
                const matchText = q.title.toLowerCase().includes(text) || q.desc.toLowerCase().includes(text);
                const matchCat = cat === "all" || q.category === cat;
                return matchText && matchCat;
            });

            renderQuizzes(filtered);
        }

        // --- MOTEUR DE JEU ---
        let game = { data: null, currentIdx: 0, score: 0 };

        function startGame(id) {
            const quiz = allQuizzes.find(q => q.id === id);
            if(!quiz) return;

            // Initialisation
            game.data = quiz;
            game.currentIdx = 0;
            game.score = 0;

            // UI
            document.getElementById('game-engine').style.display = 'flex';
            document.getElementById('game-title').innerText = quiz.title;
            document.getElementById('game-ui').style.display = 'block';
            document.getElementById('result-ui').style.display = 'none';

            loadQuestion();
        }

        function loadQuestion() {
            const q = game.data.questions[game.currentIdx];
            const total = game.data.questions.length;

            // Compteur et Barre
            document.getElementById('question-counter').innerText = `QUESTION ${game.currentIdx + 1} / ${total}`;
            document.getElementById('progress-fill').style.width = `${((game.currentIdx) / total) * 100}%`;
            
            // Texte
            document.getElementById('q-text').innerText = q.q;
            
            // Options (Mélange)
            // On map chaque option avec son index d'origine pour vérifier la réponse plus tard
            let opts = q.options.map((val, idx) => ({ txt: val, originalIdx: idx }));
            opts.sort(() => Math.random() - 0.5);

            const area = document.getElementById('options-area');
            area.innerHTML = "";
            document.getElementById('next-btn').style.display = 'none';

            opts.forEach(opt => {
                const btn = document.createElement('div');
                btn.className = 'option-card';
                btn.innerText = opt.txt;
                
                // Détection si c'est la bonne réponse
                const isCorrect = (opt.originalIdx === q.ans);
                
                btn.onclick = () => selectAnswer(btn, isCorrect);
                area.appendChild(btn);
            });
        }

        function selectAnswer(btn, isCorrect) {
            // Désactiver tous les boutons
            const all = document.querySelectorAll('.option-card');
            all.forEach(b => b.classList.add('disabled'));

            if(isCorrect) {
                btn.classList.add('correct');
                game.score++;
            } else {
                btn.classList.add('wrong');
                // Optionnel : Montrer la bonne réponse en vert (si on veut aider le joueur)
            }

            // Afficher le bouton suivant
            document.getElementById('next-btn').style.display = 'inline-block';
        }

        function nextQuestion() {
            game.currentIdx++;
            if(game.currentIdx < game.data.questions.length) {
                loadQuestion();
            } else {
                finishGame();
            }
        }

        function finishGame() {
            document.getElementById('game-ui').style.display = 'none';
            document.getElementById('result-ui').style.display = 'block';
            document.getElementById('progress-fill').style.width = '100%';

            const total = game.data.questions.length;
            document.getElementById('final-score').innerText = `${game.score} / ${total}`;

            // Message de fin
            const ratio = game.score / total;
            let msg = "Dommage, retente ta chance !";
            if(ratio >= 0.5) msg = "Bien joué !";
            if(ratio >= 0.8) msg = "Excellent score !";
            if(ratio === 1) msg = "PERFECT ! Tu es un génie.";
            
            document.getElementById('score-msg').innerText = msg;
        }

        function quitGame() {
            document.getElementById('game-engine').style.display = 'none';
        }

        // Lancement
        init();

    </script>
</body>
</html>
